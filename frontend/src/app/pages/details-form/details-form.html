<section class="page">
  <div class="container details">
    <!-- Header -->
    <header class="page__header">
      <button class="btn btn-link" (click)="volverAlHome()">← Volver al inicio</button>
      <h1 class="page__title">Detalle del Proyecto</h1>
    </header>

    <!-- Loading -->
    @if (loading) {
      <p class="alert">Cargando información del proyecto...</p>
    }

    <!-- Error -->
    @if (error && !loading) {
      <div class="alert alert-error">
        <p class="text">{{ error }}</p>
        <hr class="divider" />
        <button class="btn btn-primary" (click)="volverAlHome()">Volver al inicio</button>
      </div>
    }

    <!-- Contenido -->
    @if (project && !loading && !error) {
      <article class="card details-card" id="details-form-container">
        <!-- Card Header -->
        <div class="card__header">
          <div>
            <h2 class="card__title">{{ project.nombre }}</h2>
            <p class="text">{{ project.resumen }}</p>
          </div>

          <span [class]="getEstadoClass()">
            <span class="material-icons estado__icon" aria-hidden="true"></span>
            {{ getEstadoProyecto() }}
          </span>
        </div>

        <!-- Curso -->
        <section class="section section--curso">
          <p class="text">Curso</p>
          <p class="text">{{ project.curso }}</p>
        </section>

        <hr class="divider" />

        <!-- Autores -->
        <section class="section">
          <h3 class="section__title">Autores</h3>
          <ul class="list">
            @for (autor of autoresArray; track autor) {
              <li class="list__item">{{ autor }}</li>
            }
          </ul>
        </section>

        <hr class="divider" />

        <!-- Descripción -->
        <section class="section">
          <h3 class="section__title">Descripción del Proyecto</h3>
          <p class="text" style="white-space: pre-wrap">
            {{ project.descripcion }}
          </p>
        </section>

        <hr class="divider" />

        <!-- Tags -->
        @if (hasTags()) {
          <section class="section">
            <h3 class="section__title">Tecnologías y Etiquetas</h3>
            <ul class="tag-list">
              @for (tag of project.tags; track tag) {
                <li class="tag">{{ tag }}</li>
              }
            </ul>
          </section>

          <hr class="divider" />
        }

        <!-- Video -->
        @if (project.video_url) {
          <section class="section">
            <h3 class="section__title">Video del Proyecto</h3>

            @if (getYouTubeEmbedUrl()) {
              <iframe
                [src]="getYouTubeEmbedUrl()!"
                title="Video del proyecto"
                allowfullscreen
                style="width: 100%; aspect-ratio: 16 / 9; border: 0; border-radius: 8px"
              ></iframe>
            } @else {
              <a [href]="project.video_url" target="_blank" class="btn btn-secondary">
                Ver video
              </a>
            }
          </section>

          <hr class="divider" />
        }

        <!-- Documentos -->
        @if (hasDocumentos()) {
          <section class="section">
            <h3 class="section__title">Documentos Adjuntos</h3>
            <ul class="list">
              @for (doc of project.documentos; track doc) {
                <li class="list__item">
                  <a [href]="doc" target="_blank" rel="noopener" class="btn btn-link doc-link">
                    <span class="material-icons doc-link__icon" aria-hidden="true"></span>
                    Descargar
                  </a>
                </li>
              }
            </ul>
          </section>

          <hr class="divider" />
        }

        <!-- Observaciones -->
        @if (project.observaciones && project.observaciones !== 'null') {
          <section class="section">
            <h3 class="section__title section__title--bold">Observaciones</h3>
            <div class="alert alert-info">
              <p class="text" style="white-space: pre-wrap">
                {{ project.observaciones }}
              </p>
            </div>
          </section>
        }

        <!-- Metadatos -->
        <section class="section">
          <h3 class="section__title">Información del Sistema</h3>

          <dl class="meta">
            <div class="meta__row">
              <dt>ID del Proyecto</dt>
              <dd>#{{ project.id }}</dd>
            </div>

            <div class="meta__row">
              <dt>Fecha de Creación</dt>
              <dd>{{ project.created_at | date: 'short' }}</dd>
            </div>

            <div class="meta__row">
              <dt>Última Actualización</dt>
              <dd>{{ project.updated_at | date: 'short' }}</dd>
            </div>
          </dl>
        </section>

        <hr class="divider" />

        <!-- Footer -->
        <section class="section">
          <button class="btn btn-primary btn--icon" (click)="volverAlHome()">
            <span class="material-icons" aria-hidden="true"></span>
            Volver al Inicio
          </button>

          @if (project.video_url) {
            <a
              [href]="project.video_url"
              target="_blank"
              rel="noopener"
              class="btn btn-secondary btn--icon"
            >
              <span class="material-icons" aria-hidden="true"></span>
              Ver Video Original
            </a>
          }
        </section>
      </article>
    }
  </div>
</section>

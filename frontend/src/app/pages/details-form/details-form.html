<section class="page">
  <div class="container details">
    <!-- Header -->
    <header class="page__header">
      <button class="btn btn-link" (click)="volverAlHome()">← Volver al inicio</button>
      <h1 class="page__title">Detalle del Proyecto</h1>
    </header>

    <hr class="divider" />

    <!-- Loading -->
    @if (loading) {
      <p class="alert">Cargando información del proyecto...</p>
    }

    <!-- Error -->
    @if (error && !loading) {
      <div class="alert alert-error">
        <p class="text">{{ error }}</p>
        <hr class="divider" />
        <button class="btn btn-primary" (click)="volverAlHome()">Volver al inicio</button>
      </div>
    }

    <!-- Contenido -->
    @if (project && !loading && !error) {
      <article class="card details-card" id="details-form-container">
        <!-- Card Header -->
        <div class="card__header">
          <div>
            <h2 class="card__title">{{ project.nombre }}</h2>
            <!-- Descripción -->
            <p class="text" style="white-space: pre-wrap">{{ project.descripcion }}</p>
          </div>

          <!-- Estado proyecto -->
          <span [class]="getEstadoClass()">
            <span class="material-icons estado__icon" aria-hidden="true"></span>
            {{ getEstadoProyecto() }}
          </span>
        </div>

        <!-- Curso -->
        <section class="section section--curso">
          <p class="text"><b>Ciclo</b> {{ project.ciclo }}</p>
          <p class="text"><b>Año</b> {{ project.anio }}</p>
        </section>

        <hr class="divider" />

        <!-- Autores -->
        <section class="section">
          <h3 class="section__title"><b>Autores</b></h3>
          <ul class="list">
            @for (autor of autoresArray; track autor) {
              <li class="list__item">{{ autor }}</li>
            }
          </ul>
        </section>

        <hr class="divider" />

        <!-- Video -->
        @if (project.video_url) {
          <section class="section">
            <h3 class="section__title section__title--bold">Video del Proyecto</h3>
            <div class="video-container">
              <video
                class="video-player"
                controls
                [src]="'http://localhost:8000/storage/proyectos/' + project.video_url"
              ></video>
            </div>
          </section>
        }

        <!-- Documentos -->
        @if (hasDocumentos()) {
          <section class="section">
            <h3 class="section__title"><b>Documentos adjuntos</b></h3>
            <ul class="list">
              @for (doc of project.documentos; track doc) {
                <li class="list__item">
                  <a [href]="doc" target="_blank" rel="noopener" class="btn btn-link doc-link">
                    <span class="material-icons doc-link__icon" aria-hidden="true"></span>
                    {{ doc }}
                  </a>
                </li>
              }
            </ul>
          </section>

          <hr class="divider" />
        }

        <!-- Tags -->
        @if (hasTags()) {
          <section class="section">
            <h3 class="section__title"><b>Tecnologías y Etiquetas</b></h3>
            <ul class="tag-list">
              @for (tag of project.tags; track tag) {
                <li class="tech-tag">{{ tag }}</li>
              }
            </ul>
          </section>
        }
        <hr class="divider" />

        <!-- Observaciones -->
        @if (project.observaciones && project.observaciones !== 'null') {
          <section class="section">
            <h3 class="section__title section__title--bold"><b>Observaciones</b></h3>
            <div class="alert alert-info">
              <p class="text" style="white-space: pre-wrap">
                {{ project.observaciones }}
              </p>
            </div>
          </section>
        }

        <hr class="divider" />

        <!-- Metadatos -->
        <section class="section">
          <h3 class="section__title"><b>Información del Sistema</b></h3>

          <dl class="meta">
            <div class="meta__row">
              <dt>ID del Proyecto</dt>
              <dd>#{{ project.id }}</dd>
            </div>

            <div class="meta__row">
              <dt>Fecha de Creación</dt>
              <dd>{{ project.created_at | date: 'short' }}</dd>
            </div>

            <div class="meta__row">
              <dt>Última Actualización</dt>
              <dd>{{ project.updated_at | date: 'short' }}</dd>
            </div>
          </dl>
        </section>
      </article>
    }
  </div>
</section>

<div class="upload-form-wrapper">
  <h2>Subir proyecto</h2>

  <!-- Mensaje de √©xito -->
  <div *ngIf="mensajeExito" class="alert alert-success">‚úì {{ mensajeExito }}</div>

  <!-- Error general -->
  <div *ngIf="errorFormulario" class="alert alert-error">‚úï {{ errorFormulario }}</div>

  <form #formProyecto="ngForm" (ngSubmit)="enviarProyecto(formProyecto)" class="upload-form">
    <!-- SECCI√ìN: Informaci√≥n b√°sica -->
    <p class="form-section-title">Informaci√≥n del proyecto</p>

    <div class="form-group">
      <label for="titulo">T√≠tulo del proyecto</label>
      <input
        id="titulo"
        type="text"
        [(ngModel)]="proyecto.titulo"
        name="titulo"
        required
        #titulo="ngModel"
        placeholder="Ej: Gestor de Tareas Web"
      />
      <div *ngIf="titulo.invalid && titulo.touched" class="error">El t√≠tulo es obligatorio.</div>
    </div>

    <div class="form-group">
      <label for="autores">Autor/autores</label>
      <input
        id="autores"
        type="text"
        [(ngModel)]="autoresTexto"
        name="autores"
        placeholder="Ej: Juan P√©rez, Ana L√≥pez"
        required
        #autores="ngModel"
      />
      <div *ngIf="autores.invalid && autores.touched" class="error">
        El campo autores es obligatorio.
      </div>
    </div>

    <!-- Curso y Ciclo en fila -->
    <div class="form-row">
      <div class="form-group">
        <label for="curso">Curso acad√©mico</label>
        <select id="curso" [(ngModel)]="proyecto.curso" name="curso" required #curso="ngModel">
          <option value="" disabled selected hidden>Selecciona...</option>
          <option value="2022/2023">2022/2023</option>
          <option value="2023/2024">2023/2024</option>
          <option value="2024/2025">2024/2025</option>
          <option value="2025/2026">2025/2026</option>
        </select>
        <div *ngIf="curso.invalid && curso.touched" class="error">Selecciona un curso.</div>
      </div>

      <div class="form-group">
        <label for="ciclo">Ciclo</label>
        <select id="ciclo" [(ngModel)]="proyecto.ciclo" name="ciclo" required #ciclo="ngModel">
          <option value="" disabled selected hidden>Selecciona...</option>
          <option value="DAW">DAW</option>
          <option value="DAM">DAM</option>
          <option value="ASIR">ASIR</option>
          <option value="AF">AF</option>
          <option value="AD">AD</option>
          <option value="AUT">Automoci√≥n</option>
        </select>
        <div *ngIf="ciclo.invalid && ciclo.touched" class="error">Selecciona un ciclo.</div>
      </div>
    </div>

    <div class="form-group">
      <label>Descripci√≥n</label>
      <textarea
        [(ngModel)]="proyecto.descripcion"
        name="descripcion"
        required
        maxlength="200"
        minlength="25"
        #descripcion="ngModel"
        placeholder="Describe brevemente el proyecto (25-200 caracteres)..."
      ></textarea>
      <div *ngIf="descripcion.invalid && descripcion.touched" class="error">
        La descripci√≥n es obligatoria (entre 25 y 200 caracteres).
      </div>
    </div>

    <div class="form-group">
      <label>Etiquetas <small>(opcional)</small></label>
      <input
        type="text"
        [(ngModel)]="etiquetasTexto"
        name="etiquetas"
        placeholder="Angular, Laravel, MySQL..."
      />
    </div>

    <!-- SECCI√ìN: Archivos -->
    <p class="form-section-title">Archivos</p>

    <!-- V√≠deo -->
    <div class="form-group">
      <label>V√≠deo del proyecto <small>(obligatorio, m√°x. 30 MB)</small></label>
      <div class="file-upload-zone">
        <label class="file-upload-label" for="inputVideo">
          <span class="icon">üé¨</span>
          <span> <strong>Selecciona un v√≠deo</strong> o arr√°stralo aqu√≠ </span>
          <span *ngIf="video">{{ video.name }}</span>
        </label>
        <input
          id="inputVideo"
          type="file"
          accept="video/mp4,video/avi,video/mpeg"
          (change)="onVideoSeleccionado($event)"
        />
      </div>
      <div *ngIf="errorVideo" class="error">{{ errorVideo }}</div>
    </div>

    <!-- Documentos PDF -->
    <div class="form-group">
      <label for="archivo"
        >Documentaci√≥n PDF <small>(opcional, m√°x. 10 MB por archivo)</small></label
      >
      <div class="file-upload-zone">
        <label class="file-upload-label" for="archivo">
          <span class="icon">üìé</span>
          <span> <strong>Selecciona los PDFs</strong> o arr√°stralos aqu√≠ </span>
        </label>
        <input
          id="archivo"
          type="file"
          accept=".pdf"
          multiple
          (change)="onDocumentacionSeleccionada($event)"
        />
      </div>
      <div *ngIf="errorArchivo" class="error">{{ errorArchivo }}</div>
      <ul *ngIf="documentos.length > 0" class="file-list">
        <li *ngFor="let doc of documentos">
          {{ doc.name }} ({{ (doc.size / 1024 / 1024).toFixed(1) }} MB)
          <button type="button" (click)="eliminarDocumento(doc)">‚úï</button>
        </li>
      </ul>
    </div>

    <button type="submit" class="btn-submit" [disabled]="enviando">
      {{ enviando ? 'Enviando...' : 'Enviar proyecto' }}
    </button>
  </form>
</div>

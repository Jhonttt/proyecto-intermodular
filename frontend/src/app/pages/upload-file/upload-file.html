<div class="upload-form-wrapper">
  <h2>Subir proyecto</h2>

  <!-- Mensaje de Ã©xito -->
  <div *ngIf="mensajeExito" class="alert alert-success">âœ“ {{ mensajeExito }}</div>

  <!-- Error general -->
  <div *ngIf="errorFormulario" class="alert alert-error">âœ• {{ errorFormulario }}</div>

  <form #formProyecto="ngForm" (ngSubmit)="enviarProyecto(formProyecto)" class="upload-form">
    <!-- SECCIÃ“N: InformaciÃ³n bÃ¡sica -->
    <p class="form-section-title">InformaciÃ³n del proyecto</p>

    <div class="form-group">
      <label for="titulo">TÃ­tulo del proyecto</label>
      <input
        id="titulo"
        type="text"
        [(ngModel)]="proyecto.titulo"
        name="titulo"
        required
        #titulo="ngModel"
        placeholder="Ej: Gestor de Tareas Web"
      />
      <div *ngIf="titulo.invalid && titulo.touched" class="error">El tÃ­tulo es obligatorio.</div>
    </div>

    <div class="form-group">
      <label for="autores">Autor/autores</label>
      <input
        id="autores"
        type="text"
        [(ngModel)]="autoresTexto"
        name="autores"
        placeholder="Ej: Juan PÃ©rez, Ana LÃ³pez"
        required
        #autores="ngModel"
      />
      <div *ngIf="autores.invalid && autores.touched" class="error">
        El campo autores es obligatorio.
      </div>
    </div>

    <!-- Curso y Ciclo en fila -->
    <div class="form-row">
      <div class="form-group">
        <label for="curso">Curso acadÃ©mico</label>
        <select id="curso" [(ngModel)]="proyecto.curso" name="curso" required #curso="ngModel">
          <option value="" disabled selected hidden>Selecciona...</option>
          <option value="2022/2023">2022/2023</option>
          <option value="2023/2024">2023/2024</option>
          <option value="2024/2025">2024/2025</option>
          <option value="2025/2026">2025/2026</option>
        </select>
        <div *ngIf="curso.invalid && curso.touched" class="error">Selecciona un curso.</div>
      </div>

      <div class="form-group">
        <label for="ciclo">Ciclo</label>
        <select id="ciclo" [(ngModel)]="proyecto.ciclo" name="ciclo" required #ciclo="ngModel">
          <option value="" disabled selected hidden>Selecciona...</option>
          <option value="DAW">1Â° Desarrollo de Aplicaciones Web</option>
          <option value="DAM">1Â° Desarrollo de Aplicaciones Multiplataforma</option>
          <option value="ASIR">1Â° AdministraciÃ³n de Sistemas InformÃ¡ticos en Red</option>
          <option value="AF">1Â° AdministraciÃ³n y Finanzas</option>
          <option value="AD">1Â° Asistencia a la DirecciÃ³n</option>
          <option value="AUT">1Â° AutomociÃ³n</option>
        </select>
        <div *ngIf="ciclo.invalid && ciclo.touched" class="error">Selecciona un ciclo.</div>
      </div>
    </div>

    <div class="form-group">
      <label>DescripciÃ³n</label>
      <textarea
        [(ngModel)]="proyecto.descripcion"
        name="descripcion"
        required
        maxlength="200"
        minlength="25"
        #descripcion="ngModel"
        placeholder="Describe brevemente el proyecto (25-200 caracteres)..."
      ></textarea>
      <div *ngIf="descripcion.invalid && descripcion.touched" class="error">
        La descripciÃ³n es obligatoria (entre 25 y 200 caracteres).
      </div>
    </div>

    <div class="form-group">
      <label>Etiquetas <small>(opcional)</small></label>
      <input
        type="text"
        [(ngModel)]="etiquetasTexto"
        name="etiquetas"
        placeholder="Angular, Laravel, MySQL..."
      />
    </div>

    <!-- SECCIÃ“N: Archivos -->
    <p class="form-section-title">Archivos</p>

    <!-- VÃ­deo -->
    <div class="form-group">
      <label>VÃ­deo del proyecto <small>(obligatorio, mÃ¡x. 30 MB)</small></label>
      <div class="file-upload-zone">
        <label class="file-upload-label" for="inputVideo">
          <span class="icon">ðŸŽ¬</span>
          <span> <strong>Selecciona un vÃ­deo</strong> o arrÃ¡stralo aquÃ­ </span>
          <span *ngIf="video">{{ video.name }}</span>
        </label>
        <input
          id="inputVideo"
          type="file"
          accept="video/mp4,video/avi,video/mpeg"
          (change)="onVideoSeleccionado($event)"
        />
      </div>
      <div *ngIf="errorVideo" class="error">{{ errorVideo }}</div>
    </div>

    <!-- Documentos PDF -->
    <div class="form-group">
      <label for="archivo"
        >DocumentaciÃ³n PDF <small>(opcional, mÃ¡x. 10 MB por archivo)</small></label
      >
      <div class="file-upload-zone">
        <label class="file-upload-label" for="archivo">
          <span class="icon">ðŸ“Ž</span>
          <span> <strong>Selecciona los PDFs</strong> o arrÃ¡stralos aquÃ­ </span>
        </label>
        <input
          id="archivo"
          type="file"
          accept=".pdf"
          multiple
          (change)="onDocumentacionSeleccionada($event)"
        />
      </div>
      <div *ngIf="errorArchivo" class="error">{{ errorArchivo }}</div>
      <ul *ngIf="documentos.length > 0" class="file-list">
        <li *ngFor="let doc of documentos">
          {{ doc.name }} ({{ (doc.size / 1024 / 1024).toFixed(1) }} MB)
          <button type="button" (click)="eliminarDocumento(doc)">âœ•</button>
        </li>
      </ul>
    </div>

    <button type="submit" class="btn-submit" [disabled]="enviando">
      {{ enviando ? 'Enviando...' : 'Enviar proyecto' }}
    </button>
  </form>
</div>
